<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Your Profile â€” Trader Route</title>
  <meta name="description" content="View and manage your Trader Route account profile and messages.">
  <meta name="author" content="Trader Route">
  <link rel="icon" href="assets/logos.png" type="image/png" />

  <style>
    :root{--green:#008b6a;--dark:#006b52;--bg:#f6f8fa;}
    body{margin:0;font-family:"Inter","Segoe UI",sans-serif;background:var(--bg);color:#222;}
    header{display:flex;align-items:center;justify-content:space-between;background:#fff;
           padding:10px 40px;box-shadow:0 2px 8px rgba(0,0,0,.1);position:sticky;top:0;z-index:1000;}
    .logo-container{display:flex;align-items:center;gap:10px;cursor:pointer;}
    .logo-container img{height:45px;}
    .logo-text{font-size:15px;color:#555;font-weight:500;}
    nav{display:flex;align-items:center;gap:20px;}
    nav a{text-decoration:none;color:#000;font-weight:500;}
    nav a:hover{color:var(--green);}
    .container{max-width:900px;margin:50px auto;padding:20px;}
    h2{text-align:center;color:var(--green);margin-bottom:25px;}

    /* === Profile Card === */
    .profile-card{background:#fff;border-radius:12px;box-shadow:0 3px 10px rgba(0,0,0,0.06);
                  padding:30px;max-width:700px;margin:0 auto 25px auto;text-align:center;}
    .profile-avatar{width:90px;height:90px;border-radius:50%;object-fit:cover;
                    box-shadow:0 2px 6px rgba(0,0,0,0.15);}
    .profile-name{font-size:22px;font-weight:700;margin:15px 0 8px;}
    .profile-email{color:#666;font-size:15px;margin-bottom:20px;}
    .info-grid{display:flex;justify-content:center;flex-wrap:wrap;gap:15px;}
    .info-box{background:#f8fdfc;border:1px solid #e1f3ee;padding:15px 20px;border-radius:10px;
              min-width:200px;text-align:center;box-shadow:0 2px 4px rgba(0,0,0,0.05);}
    .info-box h4{margin:0 0 6px;font-size:15px;color:#007b63;}
    .info-box p{margin:0;font-size:14px;font-weight:600;color:#111;}
    .logout-btn{background:#d9534f;color:#fff;border:none;padding:10px 20px;border-radius:8px;
                font-weight:600;margin-top:25px;cursor:pointer;transition:.25s;}
    .logout-btn:hover{background:#c9302c;}

    /* === Inbox === */
    .inbox-section{background:#fff;border-radius:12px;box-shadow:0 3px 10px rgba(0,0,0,0.06);
                   padding:25px;max-width:700px;margin:0 auto;}
    .inbox-section h3{text-align:center;margin-top:0;color:#007b63;}
    .message-item{border:1px solid #e5e7eb;border-radius:8px;padding:12px 15px;margin-bottom:10px;
                  background:#f9fdfc;}
    .message-item strong{color:#008b6a;}
    .message-item p{margin:8px 0;font-size:14px;}
    .reply-btn{background:#008b6a;color:#fff;border:none;padding:6px 12px;border-radius:6px;
               cursor:pointer;font-size:13px;font-weight:600;transition:.2s;}
    .reply-btn:hover{background:#006b52;}
    .no-messages{text-align:center;color:#777;font-size:14px;margin-top:10px;}
  </style>
</head>

<body>
  <header>
    <div class="logo-container" onclick="location.href='index.html'">
      <img src="assets/logos.png" alt="Trader Route Logo">
      <span class="logo-text">The Silk Road of E-Commerce</span>
    </div>

    <nav>
      <a href="index.html">Home</a>
      <a href="companies.html">Companies</a>
      <a href="requests.html">Requests</a>
      <a href="contact.html">Contact</a>
      <a href="pricing.html">Pricing</a>
    </nav>
  </header>

  <div class="container">
    <h2>My Profile</h2>

    <div class="profile-card" id="profileCard">
      <img src="assets/user-icon.png" alt="User" class="profile-avatar">
      <div class="profile-name" id="profileName">-</div>
      <div class="profile-email" id="profileEmail">-</div>

      <div class="info-grid">
        <div class="info-box">
          <h4>Country</h4>
          <p id="profileCountry">-</p>
        </div>
        <div class="info-box">
          <h4>Business Category</h4>
          <p id="profileCategory">-</p>
        </div>
      </div>

      <button class="logout-btn" onclick="logoutUser()">Logout</button>
    </div>

    <!-- ðŸ’¬ Inbox Section -->
    <div class="inbox-section">
      <h3>ðŸ“¨ Inbox</h3>
      <div id="inboxMessages"></div>
    </div>
  </div>

  <script>
    // === Load user info ===
    const user = JSON.parse(localStorage.getItem("tr_user") || "null");
    if(!user){
      alert("You must log in first.");
      location.href = "login.html";
    } else {
      document.getElementById("profileName").textContent = user.name || "-";
      document.getElementById("profileEmail").textContent = user.email || "-";
      document.getElementById("profileCountry").textContent = user.country || "Not set";
      document.getElementById("profileCategory").textContent = user.category || "Not set";
    }

    // === Load Inbox Messages ===
    function renderInbox(){
      const inboxDiv = document.getElementById("inboxMessages");
      inboxDiv.innerHTML = "";
      const all = JSON.parse(localStorage.getItem("messages") || "[]");
      const myMsgs = all.filter(m => m.to === user.email);
      if(myMsgs.length === 0){
        inboxDiv.innerHTML = '<div class="no-messages">No messages yet.</div>';
        return;
      }
      myMsgs.reverse().forEach(msg=>{
        const div=document.createElement("div");
        div.className="message-item";
        div.innerHTML=`
          <strong>From:</strong> ${msg.from}<br>
          <p>${msg.text}</p>
          <button class="reply-btn" onclick="replyTo('${msg.from}')">Reply</button>
        `;
        inboxDiv.appendChild(div);
      });
    }

    function replyTo(email){
      location.href = 'messages.html?to=' + encodeURIComponent(email);
    }

    function logoutUser(){
      localStorage.removeItem("tr_user");
      location.href = "index.html";
    }

    renderInbox();
  </script>
</body>
</html>
